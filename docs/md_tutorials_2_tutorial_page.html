<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Data Shard Plugin: How to</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Icon128.png"/></td>
  <td id="projectalign">
   <div id="projectname">Data Shard Plugin
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md_tutorials_2_tutorial_page.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">How to</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a></p>
<p><a class="anchor" id="bp_section"></a></p>
<h1><a class="anchor" id="autotoc_md1"></a>
How to use in BP</h1>
<h2><a class="anchor" id="autotoc_md2"></a>
Create Shard</h2>
<p><img src="../assets/images/CreateShard.jpg" alt="Create shard BP" class="inline"/></p>
<ul>
<li>Construct a key<ul>
<li>This Key can be saved or reconstructed</li>
<li>The owner is per default 'self'. In this case it's the player Pawn</li>
</ul>
</li>
<li>Call the 'Create Shard' node</li>
<li>Connect the initial data for the shard data<ul>
<li>You can also conntect a literal</li>
<li>You need to connect something, so the datatype for the shard can be determined</li>
</ul>
</li>
</ul>
<p>Now you have created a key pointing to the new shard.</p>
<p>The owner of the key is the Blueprint actor and the key name is 'Player Health'. This key is now pointing to a float shard where the value of 'Player Init Health' is entered.</p>
<dl class="section note"><dt>Note</dt><dd>Keep in mind, that the variable 'Plazer Init Health' is not related to the shard. If the shard changed 'Player Init Health' is not affected. Not the other way around either.</dd></dl>
<h2><a class="anchor" id="autotoc_md3"></a>
Get Shard Data</h2>
<p><img src="../assets/images/GetShard.jpg" alt="Get Shard BP" class="inline"/></p>
<ul>
<li>Construct a key or use one saved in a variable<ul>
<li>In this case we use the static 'Get Player Pawn' to get our Pawn</li>
<li>We use the same name for the key as the key we have created in the step before</li>
</ul>
</li>
<li>Call the 'Get Shard Data'</li>
<li>Connect the 'Out Data' pin where it need to be<ul>
<li>Keep in mind that the pin datatype need to match exacly the shard datatype</li>
</ul>
</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>We can reconstruct keys. For this the 'Owner' and the 'Name' need to be <b>exacly</b> the same, as the key we used to create the shard</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>In this example we use the 'Get Player Pawn' node. In other situations, you have to make sure that you get the right Actor as an Owner.</dd></dl>
<h2><a class="anchor" id="autotoc_md4"></a>
Set Shard Data</h2>
<p><img src="../assets/images/SetShard.jpg" alt="Set Shard BP" class="inline"/></p>
<p>In this example we get the data before we set the data. For this we use the previous saved 'Player Health Key' variable, where the key is saved.</p>
<p>After we calculated the right value we call 'Set Shard Data' and set the new value in 'In Data'</p>
<dl class="section warning"><dt>Warning</dt><dd><em>With 'Set Shard Data' we also can change the datatype inside the shard.</em> I highly recommend to <b>not</b> do this to avoid confusion.</dd></dl>
<h2><a class="anchor" id="autotoc_md5"></a>
Binding</h2>
<p><img src="../assets/images/BindingShard.jpg" alt="Shard Binding" class="inline"/></p>
<p>Binding is one of the core features of this plugin. We get a new key. With this key we have access to an existing shard. For this we need:</p><ul>
<li>A key (as variable or as new constructed) which has access to a existing shard</li>
<li>The new Owner</li>
<li>A new Name</li>
</ul>
<p>With the 'Create Bound Key' node we get a new key which has access to the same shard as the 'parent'.</p>
<p>Now we can access the same shard data with both keys anytime and we don't need any more data forwarding.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Advanced</h2>
<p><img src="../assets/images/CreateShard_Advanced.jpg" alt="Shard Binding" class="inline"/> You can add Events which will be executed if a specific shard data changes.</p>
<p>In this example we modify the Create Shard part, where we add the 'Bind Event on Shard Data Change'. We use the same key, which we used to create the shard. No everytime the shard data changes the event 'On Shard Data Changed' will be executed and will call the 'Update Player UI Health' function.</p>
<hr  />
<p><a class="anchor" id="cpp_section"></a></p>
<h2><a class="anchor" id="autotoc_md8"></a>
How to use in C++</h2>
<p>Most of the functons we need are inside the <a class="el" href="class_data_shard_subsystem.html">DataShardSubsystem</a></p>
<h3><a class="anchor" id="autotoc_md9"></a>
Create Shard</h3>
<div class="fragment"><div class="line">.h</div>
<div class="line">UPROPERTY(EditAnywhere, BlueprintReadWrite)</div>
<div class="line">float FloatValue = 875.4f;</div>
<div class="line"> </div>
<div class="line">.cpp</div>
<div class="line">const FDataShardKey Key = {this, &quot;Test Float Key&quot;};</div>
<div class="line">UDataShardSubsystem* Sub = GetGameInstance()-&gt;GetSubsystem&lt;UDataShardSubsystem&gt;();</div>
<div class="line">Sub-&gt;CreateShard(Key, this, GET_MEMBER_NAME_CHECKED(ThisClass, FloatValue));</div>
</div><!-- fragment --><p>The <a class="el" href="group___core.html#ga51aa5f090b3a7ca06b0e708926767995">DataShardSubsystem::CreateShard</a> function has 2 overloads. The version with an Container and PropertyName are more user friendly.</p>
<dl class="section note"><dt>Note</dt><dd>instead of creating the variable <code>Key</code> you can just use the uniform initialization <code>{Owner, "Name"}</code> in the function directly.</dd></dl>
<h3><a class="anchor" id="autotoc_md10"></a>
Get Shard Data with DataShardSubsystem</h3>
<div class="fragment"><div class="line">.cpp</div>
<div class="line">const FDataShardKey Key = {this, &quot;Test Float Key&quot;};</div>
<div class="line">const float* Value = Sub-&gt;GetShardData&lt;float&gt;(Key);</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md11"></a>
Get Shard Data with Key</h3>
<div class="fragment"><div class="line">.cpp</div>
<div class="line">const float* Value = Key.GetValue&lt;float&gt;(Sub);</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md12"></a>
Get Shard Data with helper macros</h3>
<div class="fragment"><div class="line">.cpp</div>
<div class="line">const float* Value = RETURN_SHARD_DATA(float, Key)</div>
</div><!-- fragment --><p>or</p>
<div class="fragment"><div class="line">.cpp</div>
<div class="line">GET_SHARD_DATA(float, Value, Key);</div>
</div><!-- fragment --><p><code>RETURN</code> macros returns you a pointer.</p>
<p><code>GET</code> macros creates for you the pointer variable</p>
<p>There also other macros that may be usefull. Take a look at <a class="el" href="group___macros.html">Helper Macros</a></p>
<dl class="section note"><dt>Note</dt><dd>The raw pointer you get with this functions are <b>not</b> copies. This raw pointer pointing at the current value inside the shard. If the value inside the shard changes the pointer will point at the right value. Keep in mind this is not the same for the <code>COPY</code> macros.</dd></dl>
<h3><a class="anchor" id="autotoc_md13"></a>
Set Shard Data with DataShardSubsystem</h3>
<div class="fragment"><div class="line">.h</div>
<div class="line">UPROPERTY(EditAnywhere, BlueprintReadWrite)</div>
<div class="line">float FloatValue = 875.4f;</div>
<div class="line"> </div>
<div class="line">.cpp</div>
<div class="line">Sub-&gt;SetShardData(Key, this, GET_MEMBER_NAME_CHECKED(ThisClass, FloatValue));</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md14"></a>
Set Shard Data with Key</h3>
<div class="fragment"><div class="line">.h</div>
<div class="line">UPROPERTY(EditAnywhere, BlueprintReadWrite)</div>
<div class="line">float FloatValue = 875.4f;</div>
<div class="line"> </div>
<div class="line">.cpp</div>
<div class="line">Key.SetValue(Sub, this, GET_MEMBER_NAME_CHECKED(ThisClass, FloatValue));</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md15"></a>
More information</h3>
<p>Currently there is no way around to use members to create and set the shard data. We use the Unreal Reflection System (Properties), and they are created with the UHT (Unreal Header Tool) at compile time. With more complex or nested data types, like structs where more structs inside, it's to complex to build them at runtime</p>
<hr  />
<h2><a class="anchor" id="autotoc_md17"></a>
Global Keys and Global Shards</h2>
<p>You can create keys that are global. Means, there is no owner. They work the same way like the normal keys, but you can use them everywhere and they are not bound to an owner.</p>
<p><img src="../assets/images/ShardKeyGlobal.jpg" alt="Shard Key Global" class="inline"/></p>
<p><code>const FDataShardKey GlobalKey = {"Global Float Key"};</code> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
